module.exports=[18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},88367,a=>{"use strict";var b=a.i(87924),c=a.i(72131);function d(){let d=(0,c.useRef)(null),e=(0,c.useRef)({}),f=(0,c.useRef)(null),[g,h]=(0,c.useState)([]),[i,j]=(0,c.useState)("routes"),[k,l]=(0,c.useState)(null);async function m(a){let b=await fetch("/api/location"),c=await b.json(),g=[],i=[];for(let b of c){let c=await fetch(`/api/location?device_id=${b}`),f=await c.json();if(!f.length)continue;let h=f[0],j=f[f.length-1],k=new Date(h.timestamp),l=new Date(j.timestamp),m=(l.getTime()-k.getTime())/1e3,n=m>60?`${Math.floor(m/60)}m ${Math.floor(m%60)}s`:`${Math.floor(m)}s`,o=f.map(a=>(i.push([a.latitude,a.longitude,.4]),[a.latitude,a.longitude])),p=function(){let a=["#00ff00","#00ffff","#ff00ff","#ffff00","#00ff88"];return a[Math.floor(Math.random()*a.length)]}(),q=a.polyline(o,{color:p,weight:3}).addTo(d.current);e.current[b]=q;let r=Date.now()-l.getTime()<15e3;g.push({id:b,date:k.toLocaleDateString(),startTime:k.toLocaleTimeString(),endTime:l.toLocaleTimeString(),durationSec:m,durationLabel:n,distance:function(a){let b=0;for(let c=1;c<a.length;c++)b+=function(a,b,c,d){let e=Math.sin((c-a)*Math.PI/180/2)**2+Math.cos(a*Math.PI/180)*Math.cos(c*Math.PI/180)*Math.sin((d-b)*Math.PI/180/2)**2;return 12742*Math.atan2(Math.sqrt(e),Math.sqrt(1-e))}(a[c-1].latitude,a[c-1].longitude,a[c].latitude,a[c].longitude);return b}(f),status:r?"ACTIVE":"COMPLETED",latlngs:o,color:p})}f.current=a.heatLayer(i,{radius:25,blur:15}),h(g)}function n(a){j(a),"heatmap"===a?(Object.values(e.current).forEach(a=>d.current.removeLayer(a)),f.current.addTo(d.current)):(d.current.removeLayer(f.current),Object.values(e.current).forEach(a=>a.addTo(d.current)))}async function o(a){l(a),Object.values(e.current).forEach(a=>d.current.removeLayer(a));let b=e.current[a];b.addTo(d.current);let c=g.find(b=>b.id===a)?.latlngs||[];for(let a=0;a<c.length;a++)b.setLatLngs(c.slice(0,a)),await new Promise(a=>setTimeout(a,80));await new Promise(a=>setTimeout(a,800)),Object.values(e.current).forEach(a=>a.addTo(d.current)),l(null)}(0,c.useEffect)(()=>((async function(){let b=await a.A(67495),c=b.default||b;window.L=c,await a.A(83383),delete c.Icon.Default.prototype._getIconUrl,c.Icon.Default.mergeOptions({iconRetinaUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png",iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png"}),d.current=c.map("adminMap").setView([28.6139,77.209],12),c.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:""}).addTo(d.current),m(c)})(),()=>{d.current&&d.current.remove()}),[]);let p=g.reduce((a,b)=>a+b.distance,0),q=g.reduce((a,b)=>a+b.durationSec,0)/(g.length||1);return(0,b.jsxs)("div",{className:"h-screen bg-black text-green-400 font-mono flex flex-col overflow-hidden",children:[(0,b.jsxs)("div",{className:"flex justify-between px-6 py-4 border-b border-green-500/30 text-sm",children:[(0,b.jsxs)("div",{children:["TOTAL: ",g.length]}),(0,b.jsxs)("div",{children:["ACTIVE: ",g.filter(a=>"ACTIVE"===a.status).length]}),(0,b.jsxs)("div",{children:["COMPLETED: ",g.filter(a=>"COMPLETED"===a.status).length]}),(0,b.jsxs)("div",{children:["AVG DURATION: ",q.toFixed(1),"s"]}),(0,b.jsxs)("div",{children:["TOTAL DIST: ",p.toFixed(2)," km"]}),(0,b.jsxs)("div",{className:"flex gap-4",children:[(0,b.jsx)("button",{onClick:()=>n("routes"),className:"border px-3 py-1",children:"ROUTES"}),(0,b.jsx)("button",{onClick:()=>n("heatmap"),className:"border px-3 py-1",children:"HEATMAP"})]})]}),(0,b.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[(0,b.jsx)("div",{className:"w-96 p-4 border-r border-green-500/20 overflow-y-auto h-full",children:g.map(a=>(0,b.jsxs)("div",{className:"mb-4 p-4 border border-green-500/30 bg-green-500/5 hover:bg-green-500/10 transition",children:[(0,b.jsx)("div",{className:"text-xs opacity-70",children:a.id}),(0,b.jsx)("div",{className:"text-xs opacity-70",children:a.date}),(0,b.jsxs)("div",{className:"text-xs opacity-70",children:[a.startTime," â†’ ",a.endTime]}),(0,b.jsxs)("div",{className:"mt-2 text-sm",children:["DURATION: ",a.durationLabel]}),(0,b.jsxs)("div",{className:"text-sm",children:["DIST: ",a.distance.toFixed(2)," km"]}),(0,b.jsxs)("div",{className:`text-sm mt-1 ${"ACTIVE"===a.status?"animate-pulse":"opacity-60"}`,children:["STATUS: ",a.status]}),(0,b.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,b.jsx)("button",{onClick:()=>{var b;let c;return b=a.id,c=e.current[b],void d.current.fitBounds(c.getBounds())},className:"flex-1 border px-2 py-1 text-xs",children:"FOCUS"}),(0,b.jsx)("button",{onClick:()=>o(a.id),className:"flex-1 border px-2 py-1 text-xs",children:"REPLAY"})]}),k===a.id&&(0,b.jsx)("div",{className:"text-xs mt-2 animate-pulse",children:"REPLAYING..."})]},a.id))}),(0,b.jsx)("div",{id:"adminMap",className:"flex-1 h-full"})]})]})}a.s(["default",()=>d])},67495,a=>{a.v(b=>Promise.all(["server/chunks/ssr/node_modules_leaflet_dist_leaflet-src_aa14ce50.js"].map(b=>a.l(b))).then(()=>b(99661)))},83383,a=>{a.v(b=>Promise.all(["server/chunks/ssr/node_modules_leaflet_heat_dist_leaflet-heat_c31a7afe.js"].map(b=>a.l(b))).then(()=>b(42538)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__eee1f3d9._.js.map