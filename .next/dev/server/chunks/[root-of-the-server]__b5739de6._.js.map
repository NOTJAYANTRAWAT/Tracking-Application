{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///C:/Tracking%20Application/helicopter-tracker/lib/mongodb.ts"],"sourcesContent":["import { MongoClient } from \"mongodb\";\r\n\r\nconst uri = process.env.MONGODB_URI;\r\n\r\nif (!uri) {\r\n  throw new Error(\"MONGODB_URI is not defined\");\r\n}\r\n\r\nconst options = {};\r\n\r\nlet client: MongoClient;\r\nlet clientPromise: Promise<MongoClient>;\r\n\r\ndeclare global {\r\n  // allow global var in Node.js\r\n  // eslint-disable-next-line no-var\r\n  var _mongoClientPromise: Promise<MongoClient> | undefined;\r\n}\r\n\r\nif (process.env.NODE_ENV === \"development\") {\r\n  if (!global._mongoClientPromise) {\r\n    client = new MongoClient(uri, options);\r\n    global._mongoClientPromise = client.connect();\r\n  }\r\n  clientPromise = global._mongoClientPromise;\r\n} else {\r\n  client = new MongoClient(uri, options);\r\n  clientPromise = client.connect();\r\n}\r\n\r\nexport default clientPromise;\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,MAAM,QAAQ,GAAG,CAAC,WAAW;AAEnC,IAAI,CAAC,KAAK;IACR,MAAM,IAAI,MAAM;AAClB;AAEA,MAAM,UAAU,CAAC;AAEjB,IAAI;AACJ,IAAI;AAQJ,wCAA4C;IAC1C,IAAI,CAAC,OAAO,mBAAmB,EAAE;QAC/B,SAAS,IAAI,oKAAW,CAAC,KAAK;QAC9B,OAAO,mBAAmB,GAAG,OAAO,OAAO;IAC7C;IACA,gBAAgB,OAAO,mBAAmB;AAC5C;;uCAKe"}},
    {"offset": {"line": 66, "column": 0}, "map": {"version":3,"sources":["file:///C:/Tracking%20Application/helicopter-tracker/app/api/location/route.ts"],"sourcesContent":["import clientPromise from \"@/lib/mongodb\";\r\n\r\nexport async function POST(req: Request) {\r\n  const data = await req.json();\r\n\r\n  const client = await clientPromise;\r\n  const db = client.db(\"helicopterTracker\");\r\n\r\n  const result = await db.collection(\"flights\").insertOne(data);\r\n\r\n  console.log(\"Inserted:\", result.insertedId);\r\n\r\n  return Response.json({ status: \"saved\" });\r\n}\r\n\r\nexport async function GET(req: Request) {\r\n  const { searchParams } = new URL(req.url);\r\n  const deviceId = searchParams.get(\"device_id\");\r\n  const latest = searchParams.get(\"latest\");\r\n\r\n  const client = await clientPromise;\r\n  const db = client.db(\"helicopterTracker\");\r\n\r\n  // If no deviceId â†’ return all device IDs\r\n  if (!deviceId) {\r\n    const deviceIds = await db\r\n      .collection(\"flights\")\r\n      .distinct(\"device_id\");\r\n\r\n    return Response.json(deviceIds);\r\n  }\r\n\r\n  // Latest point\r\n  if (latest === \"true\") {\r\n    const latestPoint = await db\r\n      .collection(\"flights\")\r\n      .find({ device_id: deviceId })\r\n      .sort({ timestamp: -1 })\r\n      .limit(1)\r\n      .toArray();\r\n\r\n    return Response.json(latestPoint[0] || null);\r\n  }\r\n\r\n  // Full history\r\n  const history = await db\r\n    .collection(\"flights\")\r\n    .find({ device_id: deviceId })\r\n    .sort({ timestamp: 1 })\r\n    .toArray();\r\n\r\n  return Response.json(history);\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEO,eAAe,KAAK,GAAY;IACrC,MAAM,OAAO,MAAM,IAAI,IAAI;IAE3B,MAAM,SAAS,MAAM,2HAAa;IAClC,MAAM,KAAK,OAAO,EAAE,CAAC;IAErB,MAAM,SAAS,MAAM,GAAG,UAAU,CAAC,WAAW,SAAS,CAAC;IAExD,QAAQ,GAAG,CAAC,aAAa,OAAO,UAAU;IAE1C,OAAO,SAAS,IAAI,CAAC;QAAE,QAAQ;IAAQ;AACzC;AAEO,eAAe,IAAI,GAAY;IACpC,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,IAAI,GAAG;IACxC,MAAM,WAAW,aAAa,GAAG,CAAC;IAClC,MAAM,SAAS,aAAa,GAAG,CAAC;IAEhC,MAAM,SAAS,MAAM,2HAAa;IAClC,MAAM,KAAK,OAAO,EAAE,CAAC;IAErB,yCAAyC;IACzC,IAAI,CAAC,UAAU;QACb,MAAM,YAAY,MAAM,GACrB,UAAU,CAAC,WACX,QAAQ,CAAC;QAEZ,OAAO,SAAS,IAAI,CAAC;IACvB;IAEA,eAAe;IACf,IAAI,WAAW,QAAQ;QACrB,MAAM,cAAc,MAAM,GACvB,UAAU,CAAC,WACX,IAAI,CAAC;YAAE,WAAW;QAAS,GAC3B,IAAI,CAAC;YAAE,WAAW,CAAC;QAAE,GACrB,KAAK,CAAC,GACN,OAAO;QAEV,OAAO,SAAS,IAAI,CAAC,WAAW,CAAC,EAAE,IAAI;IACzC;IAEA,eAAe;IACf,MAAM,UAAU,MAAM,GACnB,UAAU,CAAC,WACX,IAAI,CAAC;QAAE,WAAW;IAAS,GAC3B,IAAI,CAAC;QAAE,WAAW;IAAE,GACpB,OAAO;IAEV,OAAO,SAAS,IAAI,CAAC;AACvB"}}]
}